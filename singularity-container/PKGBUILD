pkgname=singularity-container
pkgver=2.5.2
pkgrel=1
pkgdesc='Application containers for Linux'
arch=('x86_64')
url='https://www.sylabs.io/'
license=('BSD')

source=("https://github.com/singularityware/singularity/releases/download/${pkgver}/singularity-${pkgver}.tar.gz")
sha256sums=('eca09dbf4de5e971404a31f24d6c90081aef77075f51be8b3eb15b8715d6805e')

options=('staticlibs')

optdepends=('squashfs-tools: Docker Hub support')
depends=('python2' 'python3')

build() {
  cd "${srcdir}/singularity-${pkgver}"
  ./configure prefix=/opt/singularity
  make --jobs `nproc`
}

check() {
  cd "${srcdir}/singularity-${pkgver}"
  make --jobs `nproc` check
}

package() {
  cd "${srcdir}/singularity-${pkgver}"
  make DESTDIR=${pkgdir} install
}
